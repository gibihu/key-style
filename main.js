/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => HighlightPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  enableFeature: true,
  textOption: "Hello, Obsidian!",
  DetectPlusToColor: "green",
  action: [
    {
      id: 1,
      detect: "++",
      addDetect: true,
      style: "color: #00db31;",
      position: "start"
    },
    {
      id: 2,
      detect: "--",
      addDetect: true,
      style: "color: red;",
      position: "start"
    }
  ]
};
var HighlightPlugin = class extends import_obsidian.Plugin {
  async onload() {
    console.log("[HighlightPlugin] Loaded!");
    await this.loadSettings();
    this.addSettingTab(new MyPluginSettingTab(this.app, this));
    this.registerDomEvent(document, "keyup", (event) => {
      this.handleTyping();
    });
    this.registerDomEvent(document, "input", () => {
      this.handleTyping();
    });
    this.app.workspace.onLayoutReady(async () => {
      const cssPath = this.app.vault.adapter.getResourcePath(
        this.manifest.dir + "/style.css"
      );
      const cssText = await fetch(cssPath).then((res) => res.text());
      const styleEl = document.createElement("style");
      styleEl.textContent = cssText;
      document.head.appendChild(styleEl);
      console.log("CSS Loaded via <style> tag");
    });
  }
  // save and load settings
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
    this.handleTyping();
  }
  // main freature
  handleTyping() {
    const activeLeaf = this.app.workspace.activeLeaf;
    if (!activeLeaf)
      return;
    const editor = activeLeaf.view.sourceMode.cmEditor;
    if (!editor)
      return;
    const cursor = editor.getCursor();
    const line = editor.getLine(cursor.line);
    this.settings.action.forEach((action) => {
      const escapedDetect = action.detect.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
      const regex = new RegExp(`^${escapedDetect}\\s+(.+)`);
      if (regex.test(line)) {
        const highlightedText = line.replace(regex, (_, text) => {
          if (action.position === "start") {
            return `<span style="${action.style}">${action.addDetect ? action.detect + " " : ""}${text}</span>`;
          } else if (action.position === "end") {
            return `${text}<span style="${action.style}${action.addDetect ? " " + action.detect : ""}"></span>`;
          } else {
            return text;
          }
        });
        editor.replaceRange(highlightedText, { line: cursor.line, ch: 0 }, { line: cursor.line, ch: line.length });
      }
    });
  }
  onunload() {
    console.log("[HighlightPlugin] Unloaded!");
  }
};
var MyPluginSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "My Plugin Settings" });
    containerEl.createEl("h3", { text: "Actions" });
    new import_obsidian.Setting(containerEl).setName("Add New Action").setDesc("Add a new action to the list.").addButton((button) => button.setButtonText("Reset").onClick(async () => {
      this.plugin.settings = Object.assign({}, DEFAULT_SETTINGS);
      await this.plugin.saveSettings();
      this.display();
    })).addButton(
      (button) => button.setButtonText("Add").setCta().onClick(async () => {
        this.plugin.settings.action.push({
          id: this.plugin.settings.action.length + 1,
          detect: "",
          addDetect: true,
          style: "color: white",
          position: "start"
        });
        await this.plugin.saveSettings();
        this.display();
      })
    );
    this.plugin.settings.action.forEach((action, index) => {
      const actionSetting = new import_obsidian.Setting(containerEl);
      actionSetting.settingEl.classList.add("flex", "flex-col", "items-start");
      actionSetting.setName(`Action ${index + 1}`);
      const inputContainer = actionSetting.controlEl;
      inputContainer.classList.add("flex", "gap-2", "overflow-auto", "w-full", "h-full", "p-2");
      actionSetting.addText(
        (text) => text.setPlaceholder("Detect").setValue(action.detect).then((textEl) => textEl.inputEl.classList.add(`w-20`)).onChange(async (value) => {
          this.plugin.settings.action[index].detect = value;
          await this.plugin.saveSettings();
        })
      );
      actionSetting.addText(
        (text) => text.setPlaceholder("Style").setValue(action.style).then((textEl) => textEl.inputEl.classList.add(`w-full`)).onChange(async (value) => {
          this.plugin.settings.action[index].style = value;
          await this.plugin.saveSettings();
        })
      );
      actionSetting.addDropdown(
        (dropdown) => dropdown.addOption("start", "Start").addOption("end", "End").setValue(action.position).then((dropdownEl) => dropdownEl.selectEl.classList.add("w-20")).onChange(async (value) => {
          this.plugin.settings.action[index].position = value;
          await this.plugin.saveSettings();
        })
      );
      actionSetting.addToggle(
        (toggle) => toggle.setTooltip("Add detect text to the highlighted text.").setValue(action.addDetect).onChange(async (value) => {
          this.plugin.settings.action[index].addDetect = value;
          await this.plugin.saveSettings();
        })
      );
      actionSetting.addButton(
        (button) => button.setButtonText("\u274C").onClick(async () => {
          this.plugin.settings.action.splice(index, 1);
          await this.plugin.saveSettings();
          this.display();
        })
      );
    });
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBQbHVnaW4sIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcblxyXG5cclxuLy8gMVx1RkUwRlx1MjBFMyBcdTBFMkRcdTBFMzRcdTBFMTlcdTBFNDBcdTBFMTVcdTBFMkRcdTBFMjNcdTBFNENcdTBFNDBcdTBFMUZcdTBFMEJcdTBFNDBcdTBFMDFcdTBFNDdcdTBFMUFcdTBFMDRcdTBFNDhcdTBFMzJcdTBFMDFcdTBFMzJcdTBFMjNcdTBFMTVcdTBFMzFcdTBFNDlcdTBFMDdcdTBFMDRcdTBFNDhcdTBFMzJcclxuaW50ZXJmYWNlIE15UGx1Z2luU2V0dGluZ3Mge1xyXG4gIGVuYWJsZUZlYXR1cmU6IGJvb2xlYW47XHJcbiAgdGV4dE9wdGlvbjogc3RyaW5nO1xyXG4gIERldGVjdFBsdXNUb0NvbG9yOiBzdHJpbmc7XHJcbiAgYWN0aW9uOiB7IGlkOiBudW1iZXIsIGRldGVjdDogc3RyaW5nLCBhZGREZXRlY3Q6IGJvb2xlYW4sIHN0eWxlOiBzdHJpbmcsIHBvc2l0aW9uOiBzdHJpbmcgfVtdO1xyXG59XHJcblxyXG4vLyAyXHVGRTBGXHUyMEUzIFx1MEUwNFx1MEU0OFx1MEUzMlx1MEUxRVx1MEUzN1x1MEU0OVx1MEUxOVx1MEUxMFx1MEUzMlx1MEUxOVxyXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBNeVBsdWdpblNldHRpbmdzID0ge1xyXG4gIGVuYWJsZUZlYXR1cmU6IHRydWUsXHJcbiAgdGV4dE9wdGlvbjogXCJIZWxsbywgT2JzaWRpYW4hXCIsXHJcbiAgRGV0ZWN0UGx1c1RvQ29sb3I6IFwiZ3JlZW5cIixcclxuICBhY3Rpb246IFtcclxuICAgIHtcclxuICAgICAgaWQ6IDEsXHJcbiAgICAgIGRldGVjdDogXCIrK1wiLFxyXG4gICAgICBhZGREZXRlY3Q6IHRydWUsXHJcbiAgICAgIHN0eWxlOiBcImNvbG9yOiAjMDBkYjMxO1wiLFxyXG4gICAgICBwb3NpdGlvbjogXCJzdGFydFwiXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICBpZDogMixcclxuICAgICAgZGV0ZWN0OiBcIi0tXCIsXHJcbiAgICAgIGFkZERldGVjdDogdHJ1ZSxcclxuICAgICAgc3R5bGU6IFwiY29sb3I6IHJlZDtcIixcclxuICAgICAgcG9zaXRpb246IFwic3RhcnRcIlxyXG4gICAgfSxcclxuICBdLFxyXG59O1xyXG5cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEhpZ2hsaWdodFBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XHJcbiAgc2V0dGluZ3M6IE15UGx1Z2luU2V0dGluZ3M7XHJcblxyXG5cclxuXHJcbiAgYXN5bmMgb25sb2FkKCkge1xyXG4gICAgY29uc29sZS5sb2coXCJbSGlnaGxpZ2h0UGx1Z2luXSBMb2FkZWQhXCIpO1xyXG5cclxuXHJcbiAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xyXG4gICAgLy8gXHUwRTQwXHUwRTFFXHUwRTM0XHUwRTQ4XHUwRTIxIFNldHRpbmdzIFRhYlxyXG4gICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBNeVBsdWdpblNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcclxuXHJcbiAgICAvLyBcdTBFMkFcdTBFMjNcdTBFNDlcdTBFMzJcdTBFMDcgRXZlbnQgXHUwRTJBXHUwRTMzXHUwRTJCXHUwRTIzXHUwRTMxXHUwRTFBXHUwRTAxXHUwRTMyXHUwRTIzXHUwRTFFXHUwRTM0XHUwRTIxXHUwRTFFXHUwRTRDXHJcbiAgICB0aGlzLnJlZ2lzdGVyRG9tRXZlbnQoZG9jdW1lbnQsIFwia2V5dXBcIiwgKGV2ZW50OiBLZXlib2FyZEV2ZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuaGFuZGxlVHlwaW5nKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBcdTBFMkFcdTBFMjNcdTBFNDlcdTBFMzJcdTBFMDcgRXZlbnQgXHUwRTJBXHUwRTMzXHUwRTJCXHUwRTIzXHUwRTMxXHUwRTFBXHUwRTAxXHUwRTMyXHUwRTIzXHUwRTFFXHUwRTM0XHUwRTIxXHUwRTFFXHUwRTRDXHJcbiAgICB0aGlzLnJlZ2lzdGVyRG9tRXZlbnQoZG9jdW1lbnQsIFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLmhhbmRsZVR5cGluZygpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gbG9hZCBzdHlsZS5jc3NcclxuICAgIHRoaXMuYXBwLndvcmtzcGFjZS5vbkxheW91dFJlYWR5KGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgY3NzUGF0aCA9IHRoaXMuYXBwLnZhdWx0LmFkYXB0ZXIuZ2V0UmVzb3VyY2VQYXRoKFxyXG4gICAgICAgIHRoaXMubWFuaWZlc3QuZGlyICsgXCIvc3R5bGUuY3NzXCJcclxuICAgICAgKTtcclxuXHJcbiAgICAgIC8vIFx1MEUxNFx1MEUzNlx1MEUwNyBDU1MgXHUwRTQwXHUwRTFCXHUwRTQ3XHUwRTE5XHUwRTAyXHUwRTQ5XHUwRTJEXHUwRTA0XHUwRTI3XHUwRTMyXHUwRTIxXHJcbiAgICAgIGNvbnN0IGNzc1RleHQgPSBhd2FpdCBmZXRjaChjc3NQYXRoKS50aGVuKChyZXMpID0+IHJlcy50ZXh0KCkpO1xyXG5cclxuICAgICAgLy8gXHUwRTJBXHUwRTIzXHUwRTQ5XHUwRTMyXHUwRTA3IDxzdHlsZT4gXHUwRTQxXHUwRTI1XHUwRTQ5XHUwRTI3XHUwRTQwXHUwRTFFXHUwRTM0XHUwRTQ4XHUwRTIxIENTUyBcdTBFNDBcdTBFMDJcdTBFNDlcdTBFMzJcdTBFNDRcdTBFMUJcclxuICAgICAgY29uc3Qgc3R5bGVFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzdHlsZVwiKTtcclxuICAgICAgc3R5bGVFbC50ZXh0Q29udGVudCA9IGNzc1RleHQ7XHJcbiAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc3R5bGVFbCk7XHJcblxyXG4gICAgICBjb25zb2xlLmxvZyhcIkNTUyBMb2FkZWQgdmlhIDxzdHlsZT4gdGFnXCIpO1xyXG4gICAgfSk7XHJcblxyXG5cclxuXHJcbiAgfVxyXG5cclxuICAvLyBzYXZlIGFuZCBsb2FkIHNldHRpbmdzXHJcbiAgYXN5bmMgbG9hZFNldHRpbmdzKCkge1xyXG4gICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XHJcbiAgfVxyXG4gIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcclxuICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XHJcbiAgICB0aGlzLmhhbmRsZVR5cGluZygpO1xyXG4gIH1cclxuXHJcblxyXG4gIC8vIG1haW4gZnJlYXR1cmVcclxuICBoYW5kbGVUeXBpbmcoKSB7XHJcbiAgICBjb25zdCBhY3RpdmVMZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmFjdGl2ZUxlYWY7XHJcbiAgICBpZiAoIWFjdGl2ZUxlYWYpIHJldHVybjtcclxuXHJcbiAgICBjb25zdCBlZGl0b3IgPSBhY3RpdmVMZWFmLnZpZXcuc291cmNlTW9kZS5jbUVkaXRvcjtcclxuICAgIGlmICghZWRpdG9yKSByZXR1cm47XHJcblxyXG4gICAgY29uc3QgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvcigpO1xyXG4gICAgY29uc3QgbGluZSA9IGVkaXRvci5nZXRMaW5lKGN1cnNvci5saW5lKTtcclxuXHJcbiAgICAvLyBjb25zb2xlLmxvZyhgW0hpZ2hsaWdodFBsdWdpbl0gRWRpdGluZyBMaW5lICR7Y3Vyc29yLmxpbmV9OiBcIiR7bGluZX1cImApO1xyXG5cclxuICAgIHRoaXMuc2V0dGluZ3MuYWN0aW9uLmZvckVhY2goYWN0aW9uID0+IHtcclxuICAgICAgY29uc3QgZXNjYXBlZERldGVjdCA9IGFjdGlvbi5kZXRlY3QucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xcXVxcXFxdL2csICdcXFxcJCYnKTtcclxuICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGBeJHtlc2NhcGVkRGV0ZWN0fVxcXFxzKyguKylgKTtcclxuICAgICAgaWYgKHJlZ2V4LnRlc3QobGluZSkpIHtcclxuICAgICAgICBjb25zdCBoaWdobGlnaHRlZFRleHQgPSBsaW5lLnJlcGxhY2UocmVnZXgsIChfOiBhbnksIHRleHQ6IHN0cmluZykgPT4ge1xyXG4gICAgICAgICAgaWYgKGFjdGlvbi5wb3NpdGlvbiA9PT0gXCJzdGFydFwiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBgPHNwYW4gc3R5bGU9XCIke2FjdGlvbi5zdHlsZX1cIj4ke2FjdGlvbi5hZGREZXRlY3QgPyBhY3Rpb24uZGV0ZWN0KycgJyA6ICcnIH0ke3RleHR9PC9zcGFuPmA7XHJcbiAgICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbi5wb3NpdGlvbiA9PT0gXCJlbmRcIikge1xyXG4gICAgICAgICAgICByZXR1cm4gYCR7dGV4dH08c3BhbiBzdHlsZT1cIiR7YWN0aW9uLnN0eWxlfSR7YWN0aW9uLmFkZERldGVjdCA/ICcgJythY3Rpb24uZGV0ZWN0IDogJycgfVwiPjwvc3Bhbj5gO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRleHQ7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoaGlnaGxpZ2h0ZWRUZXh0LCB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogMCB9LCB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogbGluZS5sZW5ndGggfSk7XHJcblxyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGBbSGlnaGxpZ2h0UGx1Z2luXSBIaWdobGlnaHRlZCB0ZXh0IGFwcGxpZWQ6IFwiJHtoaWdobGlnaHRlZFRleHR9XCJgKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBvbnVubG9hZCgpIHtcclxuICAgIGNvbnNvbGUubG9nKFwiW0hpZ2hsaWdodFBsdWdpbl0gVW5sb2FkZWQhXCIpO1xyXG4gIH1cclxufVxyXG5cclxuXHJcblxyXG4vLyAzXHVGRTBGXHUyMEUzIFx1MEUyQVx1MEUyM1x1MEU0OVx1MEUzMlx1MEUwN1x1MEUyQlx1MEUxOVx1MEU0OVx1MEUzMiBTZXR0aW5nIFRhYlxyXG5jbGFzcyBNeVBsdWdpblNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcclxuICBwbHVnaW46IEhpZ2hsaWdodFBsdWdpbjtcclxuXHJcbiAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogSGlnaGxpZ2h0UGx1Z2luKSB7XHJcbiAgICBzdXBlcihhcHAsIHBsdWdpbik7XHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICB9XHJcblxyXG4gIGRpc3BsYXkoKTogdm9pZCB7XHJcbiAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xyXG5cclxuICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7IC8vIFx1MEUyNVx1MEU0OVx1MEUzMlx1MEUwNyBVSSBcdTBFNDBcdTBFMTRcdTBFMzRcdTBFMjFcclxuXHJcbiAgICBjb250YWluZXJFbC5jcmVhdGVFbChcImgyXCIsIHsgdGV4dDogXCJNeSBQbHVnaW4gU2V0dGluZ3NcIiB9KTtcclxuICAgIFxyXG4gICAgLy8gXHUyNzA1IEFjdGlvbiBTZXR0aW5nc1xyXG4gICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoM1wiLCB7IHRleHQ6IFwiQWN0aW9uc1wiIH0pO1xyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZShcIkFkZCBOZXcgQWN0aW9uXCIpXHJcbiAgICAgIC5zZXREZXNjKFwiQWRkIGEgbmV3IGFjdGlvbiB0byB0aGUgbGlzdC5cIilcclxuXHJcbiAgICAgIC5hZGRCdXR0b24oKGJ1dHRvbikgPT5cclxuICAgICAgICBidXR0b24uc2V0QnV0dG9uVGV4dChcIlJlc2V0XCIpLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTKTtcclxuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgdGhpcy5kaXNwbGF5KCk7XHJcbiAgICAgICAgfSkpXHJcbiAgICAgIC5hZGRCdXR0b24oKGJ1dHRvbikgPT5cclxuICAgICAgICBidXR0b24uc2V0QnV0dG9uVGV4dChcIkFkZFwiKS5zZXRDdGEoKS5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmFjdGlvbi5wdXNoKHtcclxuICAgICAgICAgICAgaWQ6IHRoaXMucGx1Z2luLnNldHRpbmdzLmFjdGlvbi5sZW5ndGggKyAxLFxyXG4gICAgICAgICAgICBkZXRlY3Q6IFwiXCIsXHJcbiAgICAgICAgICAgIGFkZERldGVjdDogdHJ1ZSxcclxuICAgICAgICAgICAgc3R5bGU6IFwiY29sb3I6IHdoaXRlXCIsXHJcbiAgICAgICAgICAgIHBvc2l0aW9uOiBcInN0YXJ0XCIsXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgdGhpcy5kaXNwbGF5KCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgKTtcclxuXHJcbiAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5hY3Rpb24uZm9yRWFjaCgoYWN0aW9uLCBpbmRleCkgPT4ge1xyXG4gICAgICAvLyA8ZGl2IGNsYXNzPVwiZmxleCBmbGV4LWNvbFwiPlxyXG4gICAgICBjb25zdCBhY3Rpb25TZXR0aW5nID0gbmV3IFNldHRpbmcoY29udGFpbmVyRWwpO1xyXG4gICAgICBhY3Rpb25TZXR0aW5nLnNldHRpbmdFbC5jbGFzc0xpc3QuYWRkKFwiZmxleFwiLCBcImZsZXgtY29sXCIsIFwiaXRlbXMtc3RhcnRcIik7XHJcblxyXG4gICAgICBhY3Rpb25TZXR0aW5nLnNldE5hbWUoYEFjdGlvbiAke2luZGV4ICsgMX1gKTtcclxuXHJcbiAgICAgIC8vIDxkaXY+XHJcbiAgICAgIGNvbnN0IGlucHV0Q29udGFpbmVyID0gYWN0aW9uU2V0dGluZy5jb250cm9sRWw7XHJcbiAgICAgIGlucHV0Q29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJmbGV4XCIsIFwiZ2FwLTJcIiwgXCJvdmVyZmxvdy1hdXRvXCIsIFwidy1mdWxsXCIsIFwiaC1mdWxsXCIsIFwicC0yXCIpO1xyXG5cclxuICAgICAgYWN0aW9uU2V0dGluZy5hZGRUZXh0KCh0ZXh0KSA9PlxyXG4gICAgICAgIHRleHRcclxuICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIkRldGVjdFwiKVxyXG4gICAgICAgICAgLnNldFZhbHVlKGFjdGlvbi5kZXRlY3QpXHJcbiAgICAgICAgICAudGhlbigodGV4dEVsKSA9PiB0ZXh0RWwuaW5wdXRFbC5jbGFzc0xpc3QuYWRkKGB3LTIwYCkpXHJcbiAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmFjdGlvbltpbmRleF0uZGV0ZWN0ID0gdmFsdWU7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgKTtcclxuXHJcbiAgICAgIGFjdGlvblNldHRpbmcuYWRkVGV4dCgodGV4dCkgPT5cclxuICAgICAgICB0ZXh0XHJcbiAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoXCJTdHlsZVwiKVxyXG4gICAgICAgICAgLnNldFZhbHVlKGFjdGlvbi5zdHlsZSlcclxuICAgICAgICAgIC50aGVuKCh0ZXh0RWwpID0+IHRleHRFbC5pbnB1dEVsLmNsYXNzTGlzdC5hZGQoYHctZnVsbGApKVxyXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5hY3Rpb25baW5kZXhdLnN0eWxlID0gdmFsdWU7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgKTtcclxuXHJcbiAgICAgIGFjdGlvblNldHRpbmcuYWRkRHJvcGRvd24oKGRyb3Bkb3duKSA9PlxyXG4gICAgICAgIGRyb3Bkb3duXHJcbiAgICAgICAgICAuYWRkT3B0aW9uKFwic3RhcnRcIiwgXCJTdGFydFwiKVxyXG4gICAgICAgICAgLmFkZE9wdGlvbihcImVuZFwiLCBcIkVuZFwiKVxyXG4gICAgICAgICAgLnNldFZhbHVlKGFjdGlvbi5wb3NpdGlvbilcclxuICAgICAgICAgIC50aGVuKChkcm9wZG93bkVsKSA9PiBkcm9wZG93bkVsLnNlbGVjdEVsLmNsYXNzTGlzdC5hZGQoXCJ3LTIwXCIpKVxyXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5hY3Rpb25baW5kZXhdLnBvc2l0aW9uID0gdmFsdWU7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgKTtcclxuICAgICAgYWN0aW9uU2V0dGluZy5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgICB0b2dnbGVcclxuICAgICAgICAgIC5zZXRUb29sdGlwKFwiQWRkIGRldGVjdCB0ZXh0IHRvIHRoZSBoaWdobGlnaHRlZCB0ZXh0LlwiKVxyXG4gICAgICAgICAgLnNldFZhbHVlKGFjdGlvbi5hZGREZXRlY3QpXHJcbiAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuYWN0aW9uW2luZGV4XS5hZGREZXRlY3QgPSB2YWx1ZTtcclxuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICk7XHJcbiAgICAgIC8vIDwvZGl2PiA8L2Rpdj5cclxuICAgICAgLy8gQWRkIGEgYnV0dG9uIHRvIHJlbW92ZSB0aGUgYWN0aW9uXHJcbiAgICAgIGFjdGlvblNldHRpbmcuYWRkQnV0dG9uKChidXR0b24pID0+XHJcbiAgICAgICAgYnV0dG9uLnNldEJ1dHRvblRleHQoXCJcdTI3NENcIikub25DbGljayhhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5hY3Rpb24uc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgdGhpcy5kaXNwbGF5KCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgKTtcclxuXHJcbiAgICAgIC8vIEFkZCBhIHNlcGFyYXRvciBsaW5lXHJcbiAgICAgIC8vIGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiaHJcIik7XHJcbiAgICB9KTtcclxuICB9XHJcbn0iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsc0JBQXVEO0FBYXZELElBQU0sbUJBQXFDO0FBQUEsRUFDekMsZUFBZTtBQUFBLEVBQ2YsWUFBWTtBQUFBLEVBQ1osbUJBQW1CO0FBQUEsRUFDbkIsUUFBUTtBQUFBLElBQ047QUFBQSxNQUNFLElBQUk7QUFBQSxNQUNKLFFBQVE7QUFBQSxNQUNSLFdBQVc7QUFBQSxNQUNYLE9BQU87QUFBQSxNQUNQLFVBQVU7QUFBQSxJQUNaO0FBQUEsSUFDQTtBQUFBLE1BQ0UsSUFBSTtBQUFBLE1BQ0osUUFBUTtBQUFBLE1BQ1IsV0FBVztBQUFBLE1BQ1gsT0FBTztBQUFBLE1BQ1AsVUFBVTtBQUFBLElBQ1o7QUFBQSxFQUNGO0FBQ0Y7QUFHQSxJQUFxQixrQkFBckIsY0FBNkMsdUJBQU87QUFBQSxFQUtsRCxNQUFNLFNBQVM7QUFDYixZQUFRLElBQUksMkJBQTJCO0FBR3ZDLFVBQU0sS0FBSyxhQUFhO0FB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
